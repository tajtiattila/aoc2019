package main

import (
	"strings"
	"testing"
)

func TestAstro(t *testing.T) {
	type test struct {
		bestp     point
		bestscore int

		m string
	}

	tests := []test{
		{
			pt(5, 8), 33, `
......#.#.
#..#.#....
..#######.
.#.#.###..
.#..#.....
..#....#.#
#..#....#.
.##.#..###
##...#..#.
.#....####
`,
		},
		{
			pt(1, 2), 35, `
#.#...#.#.
.###....#.
.#....#...
##.#.#.#.#
....#.#.#.
.##..###.#
..#...##..
..##....##
......#...
.####.###.
`,
		},
		{
			pt(6, 3), 41, `
.#..#..###
####.###.#
....###.#.
..###.##.#
##.##.#.#.
....###..#
..#.#..#.#
#..#.#.###
.##...##.#
.....#.#..
`,
		},
		{
			pt(11, 13), 210, `
.#..##.###...#######
##.############..##.
.#.######.########.#
.###.#######.####.#.
#####.##.#.##.###.##
..#####..#.#########
####################
#.####....###.#.#.##
##.#################
#####.##.###..####..
..######..##.#######
####.##.####...##..#
.#####..#.######.###
##...#.##########...
#.##########.#######
.####.#.###.###.#.##
....##.##.###..#####
.#.#.###########.###
#.#.#.#####.####.###
###.##.####.##.#..##
`,
		},
	}

	for _, tt := range tests {
		r := strings.NewReader(strings.TrimSpace(tt.m))
		k, err := loadastchart(r)
		if err != nil {
			t.Fatal(err)
		}

		p, score := k.findbest()
		if p != tt.bestp || score != tt.bestscore {
			t.Log(p, score, tt.bestp, tt.bestscore)
			t.Fatal("bad")
		}
	}
}
